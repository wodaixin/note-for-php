### MySQL 创建高性能索引



#### MySQL 索引的基础和类型

##### 索引的基础：

索引类似于书籍的目录，想要找到一本书的某个特定主题，需要先查找书的目录，定位对应的页码

存储引擎使用类似的方式进行数据查询，先去索引当中找到对应的值，然后根据匹配的索引找到对应的数据行



##### 索引对性能的影响：

大大减少服务器需要扫描的数据量

帮助服务器避免排序和临时表

将随机 I/O 变顺序 I/O

大大提高查询速度，降低写的速度、占用磁盘



##### 索引的使用场景：

对于非常小的表，大部分情况下全表扫描效率更高

中到大型表，索引非常有效

特大型得表，建立和使用索引的代价将随之增长，可以使用分区技术来解决



##### 索引的类型：

索引有很多种类型，都是事先在存储引擎层的

普通索引：最基本的索引，没有任何约束限制

唯一索引：与普通索引类似，但具有唯一性约束

主键索引: 特殊的唯一索引，不允许有空值

组合索引(复合索引)：将多个列组合在一起创建索引，可以覆盖多个列



外建索引：只有 InnoDB 类型的表才可以使用外键索引，保证数据的一致性，完整性和实现级联操作

全文索引：MySQL 自带的全文索引只能用于 MyISAM，并且只能对英文进行全文检索



一个表只能有一个主键索引，可以有多个唯一索引

主键索引一定是唯一索引，唯一索引不是主键索引

主键可以与外键构成参照完整性约束，防止数据不一致



#### MySQL 索引的创建原则

1. 最适合索引的列是出现在 WHERE 句中的列，或连接字句中列而不是出现在 SELECT 关键字后的列
2. 索引列的基数越大，索引的效果越好
3. 对字符串进行索引，应该制定一个前缀长度，可以节省大量的索引空间
4. 根据情况创建复合索引，复合索引可以提高查询效率
5. 避免创建过多索引，索引会额外占用磁盘空间，降低写操作效率
6. 主键尽可能选择比较短的数据类型，可以有效减少索引的磁盘空间占用提高查询效率



#### MySQL 索引的注意事项

1. 复合索引遵循`前缀原则` key(a,b,c)  where a=1 and b=2 and c=3
2. like 查询，%不能在前，可以使用全文索引
3. `columu is null` 可以使用索引
4. 如果 MySQL 估计使用索引比全表扫描更慢，会放弃使用索引
5. 如果 or 前的条件中的列有索引，后面的没有，索引都不会被用到
6. 列类型是字符串，查询时一定要给值加引号，否则索引失效

